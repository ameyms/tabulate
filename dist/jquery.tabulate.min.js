/*!  v0.1.0
(c) 2013 Amey Sakhadeo
MIT License: https://github.com/ameyms/tabulate/blob/master/LICENSE */
if(!jQuery)throw new Error("Tabulate requires jQuery");!function(a){var b=function(b){a("<div/>").text(b).html()},c=function(){var b=new a.Deferred,c={items:[],total:0,page:1};return b.resolve(c),b},d=function(a){return a},e=function(a,c,d){return b(d+"")},f=function(a){this.$el=a};f.DEFAULTS={source:c,renderer:e,cellClass:"item-cell",cellMeta:a.noop,transpose:d,pageI18n:d},f.prototype={init:function(a){this.options=this.getOptions(a),this.initHandlers(),this.$tableBody=this.$el.find("tbody"),this.$tableBody||(this.$el.find("thead").after("<tbody></tbody>"),this.$tableBody=this.$el.find("tbody"))},initHandlers:function(){this.$el.on("load",a.proxy(this.fetch,this))},fetch:function(){this.cols=this.$el.find("thead th").length;var b=this.options.source();b.done(a.proxy(this.afterFetch,this)).fail(a.proxy(this.loadFailure,this))},afterFetch:function(){this.dataSet=this.options.transpose.apply(this,arguments),this.renderRows()},loadFailure:function(){this.$el.trigger("loadfailure",arguments)},renderRows:function(){var b=this;this.$tableBody.html(""),a.each(this.dataSet.items,function(c,d){for(var e=a("<tr>"),f=0;f<b.cols;f++){var g=b.options.renderer(c,f,d,b.dataSet),h=b.options.cellClass(c,f,d,b.dataSet),i=b.options.cellMeta(c,f,d,b.dataSet),j=a("<td>");j.html(g).addClass(h).data(i),e.append(j)}b.$tableBody.append(e)}),this.$el.trigger("render")},getDefaults:function(){return f.DEFAULTS},getOptions:function(b){var c;return b=a.extend({},this.getDefaults(),this.$el.data(),b),a.isFunction(b.cellClass)||(c=b.cellClass,b.cellClass=function(){return c}),b}},a.fn.extend({tabulate:function(b){this.each(function(){var c=new f(a(this));c.init(b)})}})}(jQuery,window);